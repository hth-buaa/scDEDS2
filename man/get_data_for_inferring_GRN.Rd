% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_data_for_inferring_GRN.R
\name{get_data_for_inferring_GRN}
\alias{get_data_for_inferring_GRN}
\title{Prepare Data for Gene Regulatory Network Inference}
\usage{
get_data_for_inferring_GRN(
  interest_cell_type_branch_iGRN = interest_cell_type_branch_iGRN,
  interest_cell_type_group = interest_cell_type_group,
  n_part = 1,
  ncores = 1
)
}
\arguments{
\item{interest_cell_type_branch_iGRN}{The output of function get_branch_iGRN.}

\item{interest_cell_type_group}{The output of function cell_grouping.}

\item{n_part}{Integer. Number of partitions to slice the data for parallel processing. Default is 1 (no partitioning).}

\item{ncores}{See in ?get_interest_cell_type_data.}
}
\value{
A nested list organized by cell type and branch, containing:
\itemize{
\item For each branch: A data frame with all potential TF-TG pairs and their features, including:
\itemize{
\item \code{TG}: Target gene identifier
\item \code{TF}: Transcription factor identifier
\item \code{theta_i}: Regulatory strength from iGRN
\item \code{TFE_K}, \code{TGA_K}, \code{TGE_K}: Cell group state features for each time point K
}
\item A "GRN" element containing the combined dataset across all branches
}
}
\description{
Prepares comprehensive datasets for gene regulatory network (GRN) inference by combining iGRN with cell group state features.
The function generates all possible TF-TG pairs, adds their corresponding regulatory strength values, and integrates cell group state measurements (TFE, TGA, TGE) for each time point.
Data is processed in parallel for efficiency and can be partitioned to handle large datasets.
}
\details{
The function performs the following operations:
\enumerate{
\item For each cell type, processes each branch independently
\item Generates all possible TF-TG combinations from the iGRN matrix
\item Extracts regulatory strength (theta_i) for each TF-TG pair
\item Partitions the data into \code{n_part} subsets for parallel processing
\item In parallel, adds cell group state features (TFE, TGA, TGE) for each time point
\item Combines partitioned results and organizes them by branch
\item Creates a combined dataset across all branches
}
}
\note{
Important considerations:
\itemize{
\item Parallel processing significantly speeds up the feature addition step, especially for large datasets
\item The number of partitions (\code{n_part}) can be adjusted based on dataset size and available memory
\item The resulting data frame includes all possible TF-TG pairs, which can be large for datasets with many genes
\item The "GRN" element provides a consolidated view across all branches for comprehensive analysis
}
}
\examples{
\dontrun{
interest_cell_type_branch_iGRN = base::readRDS("./3 get iGRN/interest_cell_type_branch_iGRN.rds")
interest_cell_type_group = base::readRDS("./2.2 Data Processing - Cell Grouping/interest_cell_type_group.rds")
ncores = parallel::detectCores() - 1 # in Linux
# ncores = 1 # in Windows
n_part = ncores
interest_cell_type_branch_data_for_GRN_infer = get_data_for_inferring_GRN(
  interest_cell_type_branch_iGRN = interest_cell_type_branch_iGRN,
  interest_cell_type_group = interest_cell_type_group,
  n_part = n_part,
  ncores = ncores
)
base::saveRDS(interest_cell_type_branch_data_for_GRN_infer, file = "./5 Infer GRN/interest_cell_type_branch_data_for_GRN_infer.rds")
}
}
