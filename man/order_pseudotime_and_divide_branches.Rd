% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/order_pseudotime_and_divide_branches.R
\name{order_pseudotime_and_divide_branches}
\alias{order_pseudotime_and_divide_branches}
\title{Perform Pseudotime Ordering and Branch Partitioning}
\usage{
order_pseudotime_and_divide_branches(
  interest_cell_type_data = interest_cell_type_data
)
}
\arguments{
\item{interest_cell_type_data}{The output of function get_interest_cell_type_data.}
}
\value{
A nested list structure where:
\itemize{
\item First level: Named by cell types
\item Second level: For each cell type, a list of data frames containing:
\itemize{
\item \code{Pseudotime}: Pseudotime values for cells in the branch
\item \code{State}: Cell state assignments for the branch
}
\item Cells are ordered by pseudotime within each branch
}
}
\description{
This function performs pseudotime analysis using Monocle2 and enables interactive branch partitioning based on trajectory visualization results.
It processes scRNA-seq data for multiple cell types to reconstruct developmental trajectories and identify branching points.
}
\details{
The function performs the following steps for each cell type:
\enumerate{
\item Converts Seurat object to Monocle CellDataSet
\item Estimates size factors and dispersions
\item Performs dimensionality reduction using DDRTree
\item Orders cells by pseudotime
\item Generates visualization plots (cell states and pseudotime)
\item Interactively queries user for branch definitions based on visualizations
\item Extracts and orders cells for each defined branch
}
}
\note{
Important considerations:
\itemize{
\item Requires \code{igraph} package version 2.0.3 for compatibility with Monocle
\item Generates multiple visualization files in the output directory
\item Creates subdirectories for each cell type's analysis results
\item The function will pause for user input during execution
\item Save the returned object as it contains valuable trajectory information
}
}
\section{Interactive Input}{

The function requires user interaction to:
\itemize{
\item Specify the number of branches based on visualization results
\item Define cell state sequences for each branch
}
Users should examine the generated plots in the output directory before providing input.
}

\examples{
\dontrun{
# Perform pseudotime analysis and branch partitioning
library(DDRTree)
packageVersion("igraph")
remove.packages("igraph")
install_version("igraph", version = "2.0.3")
interest_cell_type_data = base::readRDS("./2.1 Data Processing - Pseudotime Analysis And Cell Branching Assignment/interest_cell_type_data.rds")
interest_cell_type_Branches = order_pseudotime_and_divide_branches(interest_cell_type_data)
# Please enter the number of branches based on the pseudotime 2D visualization (e.g., 3) (e.g., 5): 6
# Interactively input the integer vector of cell state order for each branch (based on visualization results in: 2.1 Data Processing - Pseudotime Analysis And Cell Branching Assignment/cell_type/).
# Please enter the integer vector of cell state order for branch 1 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 11
# Please enter the integer vector of cell state order for branch 2 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 2 10
# Please enter the integer vector of cell state order for branch 3 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 2 3 9
# Please enter the integer vector of cell state order for branch 4 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 2 3 4 8
# Please enter the integer vector of cell state order for branch 5 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 2 3 4 5 6
# Please enter the integer vector of cell state order for branch 6 (space-separated) (e.g. 1 2 3 4) (e.g. 1 2 5):
#   1 2 3 4 5 7
base::saveRDS(interest_cell_type_Branches, file = "./2.1 Data Processing - Pseudotime Analysis And Cell Branching Assignment/interest_cell_type_Branches.rds")
}
}
