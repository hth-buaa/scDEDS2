% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_interest_cell_type_data.R
\name{get_interest_cell_type_data}
\alias{get_interest_cell_type_data}
\title{Extract and Process Data for Specific Cell Types}
\usage{
get_interest_cell_type_data(
  alpha_gene = 0.99,
  alpha_cell = 0.99,
  interest_cell_type = interest_cell_type,
  Basic_Info = Basic_Info,
  ncores = 1
)
}
\arguments{
\item{alpha_gene}{Numeric (0-1). Threshold for gene filtering preliminary based on zero-expression rate.
Genes with zero-expression rate higher than this value will be removed. Default is 0.99.
It's not recommended to reset. Using default settings is advised.}

\item{alpha_cell}{Threshold for cell filtering preliminary based on zero-expression rate.
Cells with zero-expression rate higher than this value will be removed. Default is 0.99.
It's not recommended to reset. Using default settings is advised.}

\item{interest_cell_type}{Character vector. Names of cell types to extract and process (in meta.data of Seurat object).}

\item{Basic_Info}{The output of function get_expression_and_activity_matrix}

\item{ncores}{Integer. Number of cores for parallel processing. Default is 1.
Recommended to run this function in Linux for parallel computing capability.
If running on Windows, ncores must be set to 1.}
}
\value{
A named list (names correspond to cell types) where each element contains:
\itemize{
\item \code{interest_scRNAseq_for_GRN}: Filtered scRNA-seq data for the cell type
\item \code{interest_scATACseq_for_GRN}: Filtered scATAC-seq data for the cell type
\item \code{interest_gene_for_GRN}: Filtered gene vector for GRN construction
\item \code{interest_TGs}: Filtered target genes present in the cell type
\item \code{interest_TFs}: Filtered transcription factors present in the cell type
}
}
\description{
This function processes single-cell multi-omics data for specified cell types by performing rigorous quality control,
filtering genes and cells based on expression thresholds,
and ensuring consistency between RNA expression and chromatin accessibility data.
}
\details{
The function performs the following operations for each specified cell type:
\enumerate{
\item Extracts expression matrix and removes genes/cells with all zero counts
\item Applies stringent filtering based on zero-expression rates using alpha thresholds
\item Extracts and aligns activity matrix with the filtered RNA-seq data
\item Ensures consistency between RNA and ATAC datasets
\item Returns processed data ready for downstream pseudotime and GRN analysis
}
}
\note{
Important considerations:
\itemize{
\item Requires that scATACseq_for_GRN contains a "seurat_annotations" metadata column (displays cell labels)
\item Temporarily changes working directory but restores upon completion
\item Uses parallel processing (Linux) for efficiency with multiple cell types
\item Alpha parameters are critical hyperparameters that may need tuning
}
}
\examples{
\dontrun{
interest_cell_type = c("CD4 TEM", "cDc")
# interest_cell_type = "Treg"
Basic_Info = base::readRDS("./1.3 Data Preprocessing - Get Expression And Activity Matrix/Basic_Info.rds")
ncores = parallel::detectCores() - 1 # in Linux
# ncores = 1 # in Windows
interest_cell_type_data = get_interest_cell_type_data(
  interest_cell_type = interest_cell_type,
  Basic_Info = Basic_Info,
  ncores = ncores
)
base::saveRDS(interest_cell_type_data, file = "./2.1 Data Processing - Pseudotime Analysis And Cell Branching Assignment/interest_cell_type_data.rds")
}
}
