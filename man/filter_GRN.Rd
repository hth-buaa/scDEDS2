% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_GRN.R
\name{filter_GRN}
\alias{filter_GRN}
\title{Filter Gene Regulatory Network Predictions}
\usage{
filter_GRN(
  interest_cell_type_pGRN = interest_cell_type_pGRN,
  fit_loss_quantile_threshold = 0.2,
  theta_p_quantile_threshold = 0.8,
  fit_loss_upper = 0.2,
  theta_p_lower = 0.2
)
}
\arguments{
\item{interest_cell_type_pGRN}{The output of function select_best_prediction.}

\item{fit_loss_quantile_threshold}{See in ?select_best_prediction.}

\item{theta_p_quantile_threshold}{See in ?select_best_prediction.}

\item{fit_loss_upper}{See in ?select_best_prediction.}

\item{theta_p_lower}{See in ?select_best_prediction.}
}
\value{
The input list \code{interest_cell_type_pGRN} with two additional elements for each cell type:
\itemize{
\item \code{pred_summary_loose}: Data frame with regulatory interactions that pass the loose filtering criteria
\item \code{pred_summary_strict}: Data frame with regulatory interactions that pass the strict filtering criteria (no missing values)
}
}
\description{
Applies quality thresholds to filter predicted gene regulatory networks (GRN) at two stringency levels: loose and strict.
The function uses quantile-based thresholds and absolute bounds to select high-confidence regulatory interactions based on fitting loss and predicted regulatory strength (theta_p).
Results are organized by cell type and saved in separate data frames for each filtering level.
}
\details{
The filtering process applies the following criteria to the \code{pred_summary} data frame for each cell type:
\enumerate{
\item \strong{Loose Filtering}: Selects interactions where:
\itemize{
\item Fitting loss is less than the minimum of \code{fit_loss_upper} and the specified quantile threshold
\item Predicted regulatory strength is greater than the maximum of \code{theta_p_lower} and the specified quantile threshold
}
\item \strong{Strict Filtering}: Applies the same criteria as loose filtering, then removes all rows with any missing values
}
The function operates independently on each cell type's prediction summary.
}
\note{
Important considerations:
\itemize{
\item The loose filtering provides a balance between sensitivity and specificity
\item The strict filtering yields high-confidence interactions but may be overly conservative
\item Adjust quantile thresholds to control the stringency of filtering
\item The function modifies the input list by adding new elements; original data is preserved
}
}
\examples{
\dontrun{
interest_cell_type_pGRN = base::readRDS("./5 Infer GRN/interest_cell_type_pGRN.rds")
fit_loss_quantile_threshold2 = 0.2
theta_p_quantile_threshold2 = 0.8
fit_loss_upper2 = 0.2
theta_p_lower2 = 0.2
interest_cell_type_pGRN = filter_GRN(
  interest_cell_type_pGRN = interest_cell_type_pGRN,
  fit_loss_quantile_threshold = fit_loss_quantile_threshold2,
  theta_p_quantile_threshold = theta_p_quantile_threshold2,
  fit_loss_upper = fit_loss_upper2,
  theta_p_lower = theta_p_lower2
)
base::saveRDS(interest_cell_type_pGRN, file = "./5 Infer GRN/interest_cell_type_pGRN.rds")
}
}
